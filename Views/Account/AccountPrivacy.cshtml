@{
    ViewData["Title"] = "Account Privacy";
    Layout = "_SettingsLayout";
}
<div class="account-privacy-container">
    <h3 class="mb-4 fw-bold">Account privacy</h3>

    <div class="d-flex justify-content-between align-items-center p-3 border rounded-3 mb-4">
        <span class="fw-bold fs-5">Private account</span>

        <div class="form-check form-switch m-0">
            <input class="form-check-input" type="checkbox" role="switch" id="privacySwitch"
                   style="width: 3em; height: 1.5em; cursor: pointer;"
                   @(Model ? "checked" : "")
                   onchange="togglePrivacy(this)">
        </div>
    </div>

    <div class="text-muted small" style="font-size: 13px; line-height: 1.6;">
        <p class="mb-3">
            When your account is public, your profile and posts can be seen by anyone, on or off Instagram, even if they don't have an Instagram account.
        </p>
        <p class="mb-0">
            When your account is private, only the followers you approve can see what you share, including your photos or videos on hashtag and location pages, and your followers and following lists. Certain info on your profile, like your profile picture and username, is visible to everyone on and off Instagram.
            <a href="#" class="text-decoration-none">Learn more</a>
        </p>
    </div>
</div>

<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="saveToast" class="toast align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                Settings saved.
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
                function togglePrivacy(checkbox) {
            const isPrivate = checkbox.checked;

            fetch('/Account/AccountPrivacy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ IsPrivate: isPrivate })
            })
            .then(res => {
                if (res.ok) {
                    showToast();
                } else {
                    // Log lỗi ra xem cụ thể là gì
                    console.error("Lỗi:", res.status);
                    // alert("Failed to update.");
                    // checkbox.checked = !isPrivate;
                }
            })
            .catch(err => {
                console.error(err);
                // checkbox.checked = !isPrivate;
            });
        }

        function showToast() {
            const toastEl = document.getElementById('saveToast');
            const toast = new bootstrap.Toast(toastEl);
            toast.show();
        }
    </script>
}